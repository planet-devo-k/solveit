name: Notify Discord on New Discussion

on:
  discussion:
    types: [created]

jobs:
  notify-discord:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discussion info to Discord
        run: |
          MESSAGE="**ìƒˆ Discussionì´ ì‹œì‘ëìŠµë‹ˆë‹¤**\n\nğŸ’¬ **ì œëª©**: ${{ github.event.discussion.title }}\nğŸ™‹â€â™€ï¸ **ì‘ì„±ì**: ${{ github.event.discussion.user.login }}\nğŸ”— [ë°”ë¡œê°€ê¸°](${{ github.event.discussion.html_url }})"

          RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" -X POST \
            -H "Content-Type: application/json" \
            -H "Authorization: Bot ${{ secrets.REMINDER_BOT_TOKEN }}" \
            -d "{\"content\": \"$MESSAGE\"}" \
            https://discord.com/api/v10/channels/${{ secrets.DISCORD_CHANNEL_ID_SOLVEIT }}/messages)

          echo "Discord Response Code: $RESPONSE"
